<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æˆ¿å…·è‹±è¨³ã‚¯ã‚¤ã‚º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca'
                        }
                    }
                }
            }
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&family=Noto+Sans+JP:wght@300;500;700;900&display=swap');

        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background:
                radial-gradient(120% 120% at 10% 10%, rgba(99, 102, 241, 0.18), transparent 70%),
                radial-gradient(120% 120% at 90% 10%, rgba(59, 130, 246, 0.12), transparent 65%),
                linear-gradient(135deg, #f8fafc 0%, #eef2ff 100%);
        }

        .glass-card {
            backdrop-filter: blur(16px);
            background: rgba(255, 255, 255, 0.85);
        }

        .floating {
            animation: float 16s ease-in-out infinite;
        }

        .floating-delay {
            animation-delay: 6s;
        }

        @keyframes float {
            0% { transform: translateY(0) translateX(0); opacity: 0.4; }
            25% { transform: translateY(-14px) translateX(8px); opacity: 0.7; }
            50% { transform: translateY(6px) translateX(-10px); opacity: 0.5; }
            75% { transform: translateY(-12px) translateX(6px); opacity: 0.7; }
            100% { transform: translateY(0) translateX(0); opacity: 0.4; }
        }

        .confetti-piece {
            position: absolute;
            width: 8px;
            height: 14px;
            border-radius: 2px;
            opacity: 0;
        }

        @keyframes confettiFall {
            0% { transform: translate3d(var(--x-start), -10%, 0) rotate(0deg); opacity: 1; }
            100% { transform: translate3d(var(--x-end), 110vh, 0) rotate(720deg); opacity: 0; }
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-32 -right-16 w-64 h-64 rounded-full bg-brand-100 blur-3xl floating"></div>
        <div class="absolute top-40 -left-24 w-72 h-72 rounded-full bg-indigo-200 blur-2xl floating floating-delay"></div>
        <div class="absolute bottom-10 right-10 w-48 h-48 rounded-full bg-sky-200 blur-3xl floating"></div>
    </div>

    <main class="relative z-10 w-full max-w-5xl mx-auto px-4 py-12 space-y-10">
        <!-- ãƒ¬ãƒ™ãƒ«é¸æŠç”»é¢ -->
        <div id="level-selection" class="glass-card rounded-3xl shadow-xl border border-white/60 p-6 md:p-10">
            <header class="text-center space-y-3 mb-10">
                <span class="inline-flex items-center gap-2 rounded-full bg-white/80 px-5 py-2 text-sm font-semibold text-brand-600 shadow">âœ¨ æ–‡æˆ¿å…·ãƒ©ãƒãƒ¼ã‚ºå‘ã‘</span>
                <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight">æ–‡æˆ¿å…· è‹±è¨³ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h1>
                <p class="text-base md:text-lg text-slate-600 max-w-2xl mx-auto">ã“ã ã‚ã‚Šã®æ–‡æˆ¿å…·ç”¨èªã‚’è‹±èªã«è¨³ã™ã‚¯ã‚¤ã‚ºã§ã™ã€‚ãƒ’ãƒ³ãƒˆã‚’ã†ã¾ãä½¿ã„ãªãŒã‚‰ã€å…¨å•æ­£è§£ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼</p>
            </header>
            <div class="grid md:grid-cols-2 gap-6 max-w-3xl mx-auto">
                <button id="beginner-btn" class="level-btn glass-card rounded-2xl border border-brand-200 p-8 text-left hover:border-brand-400 hover:shadow-lg transition-all">
                    <div class="text-3xl mb-3">ğŸ“š</div>
                    <h2 class="text-2xl font-bold text-brand-700 mb-2">åˆç´š</h2>
                    <p class="text-slate-600 mb-4">åŸºæœ¬çš„ãªæ–‡æˆ¿å…·ãƒ–ãƒ©ãƒ³ãƒ‰ã¨ãƒ¢ãƒ‡ãƒ«åã‚’å­¦ã³ã¾ã™</p>
                    <p class="text-sm text-slate-500">100å•</p>
                </button>
                <button id="intermediate-btn" class="level-btn glass-card rounded-2xl border border-purple-200 p-8 text-left hover:border-purple-400 hover:shadow-lg transition-all">
                    <div class="text-3xl mb-3">ğŸ“</div>
                    <h2 class="text-2xl font-bold text-purple-700 mb-2">ä¸­ç´š</h2>
                    <p class="text-slate-600 mb-4">ã‚ˆã‚Šé«˜åº¦ãªæ–‡æˆ¿å…·ç”¨èªã¨è¡¨ç¾ã«æŒ‘æˆ¦ã—ã¾ã™</p>
                    <p class="text-sm text-slate-500">100å•</p>
                </button>
            </div>
        </div>

        <!-- ã‚¯ã‚¤ã‚ºç”»é¢ -->
        <div id="quiz-container" class="hidden">
            <header class="text-center space-y-3 mb-6">
                <div class="flex items-center justify-center gap-3">
                    <button id="back-to-levels" class="text-slate-500 hover:text-slate-700 transition">â† ãƒ¬ãƒ™ãƒ«é¸æŠã«æˆ»ã‚‹</button>
                    <span id="current-level" class="inline-flex items-center gap-2 rounded-full bg-white/80 px-5 py-2 text-sm font-semibold text-brand-600 shadow"></span>
                </div>
                <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight">æ–‡æˆ¿å…· è‹±è¨³ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h1>
                <p class="text-base md:text-lg text-slate-600 max-w-2xl mx-auto">ã“ã ã‚ã‚Šã®æ–‡æˆ¿å…·ç”¨èªã‚’è‹±èªã«è¨³ã™ã‚¯ã‚¤ã‚ºã§ã™ã€‚ãƒ’ãƒ³ãƒˆã‚’ã†ã¾ãä½¿ã„ãªãŒã‚‰ã€å…¨å•æ­£è§£ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼</p>
            </header>

            <section class="glass-card rounded-3xl shadow-xl border border-white/60 p-6 md:p-10 space-y-8">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div class="space-y-2">
                        <p id="progress" class="text-lg md:text-xl font-semibold text-brand-600">å• 1 / 100</p>
                        <div class="w-full md:w-72 h-3 rounded-full bg-slate-200 overflow-hidden">
                            <div id="progress-bar" class="h-full w-0 bg-gradient-to-r from-brand-500 to-sky-400 transition-all duration-500 ease-out"></div>
                        </div>
                    </div>
                    <div class="flex flex-wrap items-center gap-3 text-sm">
                        <span id="score-display" class="px-3 py-1 rounded-full bg-green-100 text-green-700 font-semibold">æ­£è§£æ•°: 0</span>
                        <span id="streak-display" class="px-3 py-1 rounded-full bg-amber-100 text-amber-700 font-semibold">é€£ç¶šæ­£è§£: 0</span>
                        <span id="hint-usage" class="px-3 py-1 rounded-full bg-violet-100 text-violet-700 font-semibold">ãƒ’ãƒ³ãƒˆä½¿ç”¨: 0</span>
                    </div>
                </div>

                <div class="grid gap-6 md:grid-cols-[minmax(0,1fr)]">
                    <article class="rounded-2xl border border-brand-100 bg-gradient-to-br from-brand-50 to-white p-6 shadow-inner space-y-4">
                        <div class="flex items-center gap-3">
                            <span class="inline-flex h-10 w-10 items-center justify-center rounded-xl bg-white text-brand-600 text-xl font-bold shadow-sm">JP</span>
                            <h2 class="text-xl font-bold text-brand-700">æ—¥æœ¬èªã®ãƒ•ãƒ¬ãƒ¼ã‚º</h2>
                        </div>
                        <p id="japanese-text" class="text-2xl font-black text-slate-900 leading-relaxed"></p>
                        <button id="hint-button" class="inline-flex items-center gap-2 text-sm font-semibold text-brand-600 hover:text-brand-700 transition">ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹</button>
                        <p id="hint-text" class="hidden mt-2 rounded-xl bg-white/90 border border-dashed border-brand-200 px-4 py-3 text-sm text-slate-600"></p>
                    </article>

                    <div class="space-y-4">
                        <p class="text-sm font-semibold text-slate-600 uppercase tracking-wide">å˜èªã‚’ã‚¿ãƒƒãƒ—ã—ã¦è‹±è¨³ã‚’ä¸¦ã¹æ›¿ãˆã¦ãã ã•ã„</p>
                        <div class="space-y-4">
                            <div>
                                <p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">å˜èªãƒãƒ³ã‚¯</p>
                                <div id="word-bank" class="flex flex-wrap gap-2 rounded-2xl border border-brand-100 bg-white/60 p-3 min-h-[3rem]"></div>
                            </div>
                            <div>
                                <p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">ã‚ãªãŸã®è‹±è¨³</p>
                                <div id="assembled-answer" class="flex flex-wrap gap-2 rounded-2xl border border-dashed border-brand-200 bg-white/70 p-3 min-h-[3rem]"></div>
                            </div>
                        </div>
                        <div class="flex flex-col md:flex-row gap-3 pt-1">
                            <button id="check-button" class="flex-1 inline-flex justify-center items-center gap-2 rounded-2xl bg-brand-600 px-4 py-3 text-base font-semibold text-white shadow-lg hover:bg-brand-700 transition disabled:bg-brand-300 disabled:shadow-none">âœ… ç­”ãˆã‚’ç¢ºå®š</button>
                            <button id="next-button" class="flex-1 inline-flex justify-center items-center gap-2 rounded-2xl bg-slate-200 px-4 py-3 text-base font-semibold text-slate-700 shadow hover:bg-slate-300 transition hidden" disabled>â¡ï¸ æ¬¡ã®å•é¡Œã¸</button>
                        </div>
                    </div>
                </div>

                <div id="feedback-area" class="min-h-[6rem] transition-all duration-500"></div>

                <div id="answer-box" class="hidden rounded-2xl border border-green-200 bg-green-50/80 p-5 shadow-inner space-y-3">
                    <p class="text-sm font-semibold text-green-600 uppercase tracking-wide">æ­£è§£</p>
                    <p id="correct-answer" class="font-mono text-lg text-green-900"></p>
                </div>
            </section>

            <footer class="text-center text-sm text-slate-500 mt-6">
                <button id="review-wrong-btn" class="text-brand-600 hover:text-brand-700 underline hidden">ğŸ“ é–“é•ã£ãŸå•é¡Œã‚’ç¢ºèªã™ã‚‹</button>
            </footer>
        </div>

        <!-- é–“é•ã£ãŸå•é¡Œãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ -->
        <div id="review-container" class="hidden">
            <div class="glass-card rounded-3xl shadow-xl border border-white/60 p-6 md:p-10">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-3xl font-black text-brand-600">é–“é•ã£ãŸå•é¡Œã®ç¢ºèª</h2>
                    <button id="close-review" class="text-slate-500 hover:text-slate-700 transition">âœ• é–‰ã˜ã‚‹</button>
                </div>
                <div id="review-list" class="space-y-4"></div>
            </div>
        </div>
    </main>

    <div id="confetti-container" class="pointer-events-none fixed inset-0 overflow-hidden"></div>

    <script>
        // åˆç´šå•é¡Œï¼ˆãƒ¢ãƒ‡ãƒ«åã¾ã§å«ã‚€ï¼‰
        const beginnerQuestions = [
            {"id": 1, "jp": "ç§ã¯PILOTã®Hi-Tec-Cã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a PILOT Hi-Tec-C."},
            {"id": 2, "jp": "ã“ã‚Œã¯ZEBRAã®Sarasa Clipã§ã™ã€‚", "en": "This is a ZEBRA Sarasa Clip."},
            {"id": 3, "jp": "ç§ã®é‰›ç­†ã¯STAEDTLERã®Mars Lumographã§ã™ã€‚", "en": "My pencil is a STAEDTLER Mars Lumograph."},
            {"id": 4, "jp": "ã‚ãªãŸã¯uniã®Kuru Togaã‚’ä½¿ã„ã¾ã™ã‹ï¼Ÿ", "en": "Do you use a uni Kuru Toga?"},
            {"id": 5, "jp": "ç§ã®æ¶ˆã—ã‚´ãƒ ã¯Tombowã®MONOã§ã™ã€‚", "en": "My eraser is a Tombow MONO."},
            {"id": 6, "jp": "ç§ã®å…„ã¯LAMYã®Safariã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "My brother uses a LAMY Safari."},
            {"id": 7, "jp": "ç§ã¯KOKUYOã®Campusãƒãƒ¼ãƒˆãŒå¤§å¥½ãã§ã™ã€‚", "en": "I love KOKUYO Campus notebooks."},
            {"id": 8, "jp": "ã“ã‚Œã¯Pentelã®EnerGelã§ã™ã‹ï¼Ÿ", "en": "Is this a Pentel EnerGel?"},
            {"id": 9, "jp": "ç§ã®å®šè¦ã¯ç„¡å°è‰¯å“ã®ã‚¢ãƒ«ãƒŸå®šè¦ã§ã™ã€‚", "en": "My ruler is a MUJI aluminum ruler."},
            {"id": 10, "jp": "å½¼å¥³ã¯Faber-Castellã®Polychromosè‰²é‰›ç­†ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "She has Faber-Castell Polychromos colored pencils."},
            {"id": 11, "jp": "ç§ã®ç­†ç®±ã¯Pilotã®Siderã§ã™ã€‚", "en": "My pencil case is a Pilot Sider."},
            {"id": 12, "jp": "å½¼ã¯Sakuraã®Pigma Micronã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "He uses a Sakura Pigma Micron."},
            {"id": 13, "jp": "ã‚ãªãŸã¯ã©ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã®ãƒãƒ¼ãƒˆã‚’ä½¿ã„ã¾ã™ã‹ï¼Ÿ", "en": "Which brand of notebook do you use?"},
            {"id": 14, "jp": "ã“ã‚Œã¯Tombowã®MONOæ¶ˆã—ã‚´ãƒ ã§ã™ã€‚", "en": "This is a Tombow MONO eraser."},
            {"id": 15, "jp": "ç§ã¯STAEDTLERã®925 25ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a STAEDTLER 925 25."},
            {"id": 16, "jp": "ãã®ãƒšãƒ³ã¯LAMYã®Al-Starã§ã™ã€‚", "en": "That pen is a LAMY Al-Star."},
            {"id": 17, "jp": "ç§ã¯KOKUYOã®Smart Ring Binderã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a KOKUYO Smart Ring Binder."},
            {"id": 18, "jp": "ã‚ãªãŸã¯ã©ã“ã§ZEBRAã®Sarasaã‚’è²·ã„ã¾ã—ãŸã‹ï¼Ÿ", "en": "Where did you buy the ZEBRA Sarasa?"},
            {"id": 19, "jp": "ç§ã®æ¯ã¯Moleskineã®Classicãƒãƒ¼ãƒˆã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "My mother uses a Moleskine Classic notebook."},
            {"id": 20, "jp": "ç§ã¯uni-ballã®Signo DXã§æ›¸ãã¾ã™ã€‚", "en": "I write with a uni-ball Signo DX."},
            {"id": 21, "jp": "ã“ã‚Œã¯Pentelã®Ain STEINã§ã™ã€‚", "en": "This is a Pentel Ain STEIN."},
            {"id": 22, "jp": "ã‚ãªãŸã®ãƒšãƒ³ã¯Tombowã®Zoom 828ã§ã™ã‹ï¼Ÿ", "en": "Is your pen a Tombow Zoom 828?"},
            {"id": 23, "jp": "å½¼ã®é‰›ç­†ã¯Faber-Castellã®9000ã§ã™ã€‚", "en": "His pencil is a Faber-Castell 9000."},
            {"id": 24, "jp": "ã“ã‚Œã¯æ—¥æœ¬è£½ã®æ–‡æˆ¿å…·ã§ã™ã€‚", "en": "This is a Japanese stationery item."},
            {"id": 25, "jp": "ç§ã¯PILOTã®FriXion Ballã‚’ä½¿ã„ã¾ã™ã€‚", "en": "I use a PILOT FriXion Ball."},
            {"id": 26, "jp": "ãã®ãƒšãƒ³ã¯æ›¸ãã‚„ã™ã„ã§ã™ã‹ï¼Ÿ", "en": "Is that pen easy to write with?"},
            {"id": 27, "jp": "ç§ã¯ZEBRAã®Mildlinerã‚’3æœ¬æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have three ZEBRA Mildliners."},
            {"id": 28, "jp": "å½¼å¥³ã¯LAMYã®Studioã®èµ¤ã„ãƒšãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "She has a red LAMY Studio pen."},
            {"id": 29, "jp": "ç§ã¯KOKUYOã®Campusãƒãƒ¼ãƒˆã‚’æ¯æ—¥ä½¿ã„ã¾ã™ã€‚", "en": "I use a KOKUYO Campus notebook every day."},
            {"id": 30, "jp": "ã“ã‚Œã¯Pentelã®GraphGear 1000ã§ã™ã€‚", "en": "This is a Pentel GraphGear 1000."},
            {"id": 31, "jp": "å½¼ã¯Tombowã®MONOæ¶ˆã—ã‚´ãƒ ã‚’ã‚ˆãä½¿ã„ã¾ã™ã€‚", "en": "He often uses a Tombow MONO eraser."},
            {"id": 32, "jp": "ç§ã®é‰›ç­†ã¯çŸ­ã„ã§ã™ã€‚", "en": "My pencil is short."},
            {"id": 33, "jp": "ãã®ã‚·ãƒ£ãƒ¼ãƒ—ãƒšãƒ³ã¯é«˜ã„ã§ã™ã‹ï¼Ÿ", "en": "Is that mechanical pencil expensive?"},
            {"id": 34, "jp": "ç§ã¯Pentelã®N50ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a Pentel N50."},
            {"id": 35, "jp": "å½¼å¥³ã¯KOKUYOã®Air Touchãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "She has a KOKUYO Air Touch file."},
            {"id": 36, "jp": "ã“ã‚Œã¯ZEBRAã®ãƒœãƒ¼ãƒ«ãƒšãƒ³ã§ã™ã‹ï¼Ÿ", "en": "Is this a ZEBRA ballpoint pen?"},
            {"id": 37, "jp": "ç§ã¯STAEDTLERã®Norisé‰›ç­†ãŒå¥½ãã§ã™ã€‚", "en": "I like STAEDTLER Noris pencils."},
            {"id": 38, "jp": "ã‚ãªãŸã®ãƒãƒ¼ãƒˆã¯ç„¡å°è‰¯å“ã§ã™ã‹ï¼Ÿ", "en": "Is your notebook MUJI?"},
            {"id": 39, "jp": "å½¼ã¯LAMYã®2000ä¸‡å¹´ç­†ã‚’ä½¿ã„ã¾ã™ã€‚", "en": "He uses a LAMY 2000 fountain pen."},
            {"id": 40, "jp": "ç§ã¯uniã®Kuru Togaã®0.5mmã‚’ä½¿ã„ã¾ã™ã€‚", "en": "I use a 0.5mm uni Kuru Toga."},
            {"id": 41, "jp": "ã‚ãªãŸã¯ã©ã®æ¶ˆã—ã‚´ãƒ ãŒå¥½ãã§ã™ã‹ï¼Ÿ", "en": "Which eraser do you like?"},
            {"id": 42, "jp": "ã“ã‚Œã¯Tombowã®Zoom 828ã‚·ãƒ£ãƒ¼ãƒ—ãƒšãƒ³ã§ã™ã€‚", "en": "This is a Tombow Zoom 828 mechanical pencil."},
            {"id": 43, "jp": "ç§ã¯Pentelã®Touch Sign Penã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a Pentel Touch Sign Pen."},
            {"id": 44, "jp": "ãã®å®šè¦ã¯é€æ˜ã§ã™ã€‚", "en": "That ruler is transparent."},
            {"id": 45, "jp": "ç§ã®ãƒãƒ¼ãƒˆã¯B5ã‚µã‚¤ã‚ºã§ã™ã€‚", "en": "My notebook is B5 size."},
            {"id": 46, "jp": "ç§ã¯LAMYã®Safariã®ãƒ–ãƒ«ãƒ¼ãƒšãƒ³ã‚’è²·ã„ã¾ã—ãŸã€‚", "en": "I bought a blue LAMY Safari pen."},
            {"id": 47, "jp": "å½¼å¥³ã¯ZEBRAã®Mildlinerã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "She uses a ZEBRA Mildliner."},
            {"id": 48, "jp": "ã“ã‚Œã¯KOKUYOã®Campusãƒãƒ¼ãƒˆã§ã™ã€‚", "en": "This is a KOKUYO Campus notebook."},
            {"id": 49, "jp": "ç§ã®å‹é”ã¯Moleskineã®Weekly Plannerã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "My friend has a Moleskine Weekly Planner."},
            {"id": 50, "jp": "ã‚ãªãŸã¯ã©ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã®ãƒšãƒ³ãŒå¥½ãã§ã™ã‹ï¼Ÿ", "en": "Which pen brand do you like?"},
            {"id": 51, "jp": "å½¼ã¯uni-ballã®Eyeã‚’ä½¿ã„ã¾ã™ã€‚", "en": "He uses a uni-ball Eye."},
            {"id": 52, "jp": "ã“ã‚Œã¯Faber-Castellã®Gripé‰›ç­†ã‚»ãƒƒãƒˆã§ã™ã€‚", "en": "This is a Faber-Castell Grip pencil set."},
            {"id": 53, "jp": "ãã®æ¶ˆã—ã‚´ãƒ ã¯Tombowã§ã™ã‹ï¼Ÿ", "en": "Is that eraser Tombow?"},
            {"id": 54, "jp": "ç§ã¯Pentelã®EnerGelã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a Pentel EnerGel."},
            {"id": 55, "jp": "ã“ã‚Œã¯PILOTã®Juiceã§ã™ã€‚", "en": "This is a PILOT Juice."},
            {"id": 56, "jp": "å½¼å¥³ã¯ZEBRAã®MildlinerãŒå¥½ãã§ã™ã€‚", "en": "She likes ZEBRA Mildliners."},
            {"id": 57, "jp": "ã‚ãªãŸã®ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã¯ã©ã“è£½ã§ã™ã‹ï¼Ÿ", "en": "Where is your pencil case from?"},
            {"id": 58, "jp": "ç§ã®å…„ã¯LAMYã®Safariä¸‡å¹´ç­†ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚", "en": "My brother collects LAMY Safari fountain pens."},
            {"id": 59, "jp": "ç§ã®æ¯ã¯Moleskineã®Classicãƒãƒ¼ãƒˆã‚’æ¯æ—¥ä½¿ã„ã¾ã™ã€‚", "en": "My mother uses a Moleskine Classic notebook every day."},
            {"id": 60, "jp": "ã“ã‚Œã¯Pentelã®Sign Penã§ã™ã€‚", "en": "This is a Pentel Sign Pen."},
            {"id": 61, "jp": "ãã®ãƒšãƒ³ã¯PILOTã®Custom 74ã§ã™ã€‚", "en": "That pen is a PILOT Custom 74."},
            {"id": 62, "jp": "ç§ã¯Tombowã®ãƒšãƒ³ãŒå¥½ãã§ã™ã€‚", "en": "I like Tombow pens."},
            {"id": 63, "jp": "ã‚ãªãŸã¯ã©ã®è‰²ã®è›å…‰ãƒšãƒ³ã‚’ä½¿ã„ã¾ã™ã‹ï¼Ÿ", "en": "Which color highlighter do you use?"},
            {"id": 64, "jp": "å½¼ã®ãƒãƒ¼ãƒˆã¯KOKUYOã§ã™ã€‚", "en": "His notebook is KOKUYO."},
            {"id": 65, "jp": "ç§ã¯STAEDTLERã®Norisé’ã„é‰›ç­†ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a blue STAEDTLER Noris pencil."},
            {"id": 66, "jp": "ã“ã‚Œã¯ZEBRAã®Sarasaã§ã™ã€‚", "en": "This is a ZEBRA Sarasa."},
            {"id": 67, "jp": "å½¼å¥³ã¯PILOTã®FriXion Ballã§ãƒãƒ¼ãƒˆã‚’æ›¸ãã¾ã™ã€‚", "en": "She writes her notes with a PILOT FriXion Ball."},
            {"id": 68, "jp": "å½¼ã¯LAMYã®Al-Starã®é»’ã„ãƒšãƒ³ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "He uses a black LAMY Al-Star pen."},
            {"id": 69, "jp": "ç§ã®ãƒšãƒ³ã¯Pentel EnerGelã§ã™ã€‚", "en": "My pen is a Pentel EnerGel."},
            {"id": 70, "jp": "ã‚ãªãŸã¯ã©ã“ã§Tombowã®Zoom 828ã‚’è²·ã„ã¾ã—ãŸã‹ï¼Ÿ", "en": "Where did you buy the Tombow Zoom 828?"},
            {"id": 71, "jp": "ç§ã¯KOKUYOã®Campusãƒ«ãƒ¼ã‚ºãƒªãƒ¼ãƒ•ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use KOKUYO Campus loose-leaf paper."},
            {"id": 72, "jp": "å½¼å¥³ã¯uni-ballã®Signo DXã®é»’ã„ãƒšãƒ³ã‚’ä½¿ã„ã¾ã™ã€‚", "en": "She uses a black uni-ball Signo DX pen."},
            {"id": 73, "jp": "ã‚ãªãŸã¯PILOTã®Hi-Tec-CãŒå¥½ãã§ã™ã‹ï¼Ÿ", "en": "Do you like PILOT Hi-Tec-C pens?"},
            {"id": 74, "jp": "ç§ã¯ZEBRAã®Sarasa Clipã‚’æ¯æ—¥ä½¿ã„ã¾ã™ã€‚", "en": "I use ZEBRA Sarasa Clip pens every day."},
            {"id": 75, "jp": "å½¼ã®ç­†ç®±ã¯KOKUYOã§ã™ã€‚", "en": "His pencil case is KOKUYO."},
            {"id": 76, "jp": "ã“ã‚Œã¯STAEDTLERã®Mars Technicoã‚·ãƒ£ãƒ¼ãƒ—ãƒŠãƒ¼ã§ã™ã€‚", "en": "This is a STAEDTLER Mars Technico sharpener."},
            {"id": 77, "jp": "ç§ã¯Pentelã®EnerGelã®ã‚ªãƒ¬ãƒ³ã‚¸ãƒšãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have an orange Pentel EnerGel pen."},
            {"id": 78, "jp": "ã‚ãªãŸã®å®šè¦ã¯ã©ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã§ã™ã‹ï¼Ÿ", "en": "What brand is your ruler?"},
            {"id": 79, "jp": "å½¼å¥³ã¯Tombowã®MONOæ¶ˆã—ã‚´ãƒ ã‚’ä½¿ã„ã¾ã™ã€‚", "en": "She uses a Tombow MONO eraser."},
            {"id": 80, "jp": "ãã®ãƒãƒ¼ãƒˆã¯Moleskineã®æ–°ä½œã§ã™ã€‚", "en": "That notebook is a new Moleskine model."},
            {"id": 81, "jp": "ç§ã®å¥½ããªãƒ–ãƒ©ãƒ³ãƒ‰ã¯PILOTã§ã™ã€‚", "en": "My favorite brand is PILOT."},
            {"id": 82, "jp": "ã‚ãªãŸã¯LAMYã®Safariã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", "en": "Do you have a LAMY Safari?"},
            {"id": 83, "jp": "ç§ã¯ZEBRAã®Mildlinerã‚’2æœ¬æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have two ZEBRA Mildliners."},
            {"id": 84, "jp": "å½¼ã¯KOKUYOã®Air Touchã‚¯ãƒªã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã„ã¾ã™ã€‚", "en": "He uses a KOKUYO Air Touch clear file."},
            {"id": 85, "jp": "ã“ã‚Œã¯Pentelã®Touch Sign Penã§ã™ã€‚", "en": "This is a Pentel Touch Sign Pen."},
            {"id": 86, "jp": "ç§ã®ãƒãƒ¼ãƒˆã¯ç„¡å°è‰¯å“ã®ã‚‚ã®ã§ã™ã€‚", "en": "My notebook is from MUJI."},
            {"id": 87, "jp": "ã‚ãªãŸã¯ã©ã‚“ãªãƒšãƒ³ã§æ›¸ãã¾ã™ã‹ï¼Ÿ", "en": "What kind of pen do you write with?"},
            {"id": 88, "jp": "å½¼å¥³ã¯STAEDTLERã®925 25è£½å›³ç”¨ã‚·ãƒ£ãƒ¼ãƒ—ãƒšãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "She has a STAEDTLER 925 25 drafting pencil."},
            {"id": 89, "jp": "ãã®æ¶ˆã—ã‚´ãƒ ã¯ã‚ˆãæ¶ˆãˆã¾ã™ã€‚", "en": "That eraser erases well."},
            {"id": 90, "jp": "ç§ã¯PILOTã®Hi-Tec-Cã‚’ä½¿ã„ã¾ã™ã€‚", "en": "I use a PILOT Hi-Tec-C."},
            {"id": 91, "jp": "ã‚ãªãŸã¯Faber-Castellã®Polychromosè‰²é‰›ç­†ã‚’æŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", "en": "Do you have Faber-Castell Polychromos colored pencils?"},
            {"id": 92, "jp": "ç§ã®ãƒšãƒ³ã¯LAMYã®Safariã§ã™ã€‚", "en": "My pen is a LAMY Safari."},
            {"id": 93, "jp": "ã“ã‚Œã¯ZEBRAã®Sarasa Clipã§ã™ã€‚", "en": "This is a ZEBRA Sarasa Clip."},
            {"id": 94, "jp": "å½¼å¥³ã¯Pentelã®Touch Sign Penã§çµµã‚’æãã¾ã™ã€‚", "en": "She draws with a Pentel Touch Sign Pen."},
            {"id": 95, "jp": "ç§ã¯KOKUYOã®Campusãƒãƒ¼ãƒˆã§å‹‰å¼·ã—ã¾ã™ã€‚", "en": "I study with a KOKUYO Campus notebook."},
            {"id": 96, "jp": "ã“ã‚Œã¯Tombowã®MONOä¿®æ­£ãƒ†ãƒ¼ãƒ—ã§ã™ã€‚", "en": "This is a Tombow MONO correction tape."},
            {"id": 97, "jp": "ãã®ãƒšãƒ³ã¯STAEDTLERã®è£½å“ã§ã™ã‹ï¼Ÿ", "en": "Is that pen a STAEDTLER product?"},
            {"id": 98, "jp": "å½¼ã¯PILOTã®Juiceã‚¸ã‚§ãƒ«ãƒšãƒ³ã‚’ä½¿ã„ã¾ã™ã€‚", "en": "He uses a PILOT Juice gel pen."},
            {"id": 99, "jp": "ç§ã®å¥½ããªãƒãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒ‰ã¯KOKUYOã§ã™ã€‚", "en": "My favorite notebook brand is KOKUYO."},
            {"id": 100, "jp": "ç§ã¯ä¸–ç•Œä¸­ã®æ–‡æˆ¿å…·ã‚’é›†ã‚ãŸã„ã§ã™ã€‚", "en": "I want to collect stationery from all over the world."}
        ];

        // ä¸­ç´šå•é¡Œï¼ˆæ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒ‰ã‚’å«ã‚€ï¼‰
        const intermediateQuestions = [
            {"id": 101, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a Nohara Kogei fountain pen."},
            {"id": 102, "jp": "ã“ã‚Œã¯å·¥æˆ¿æ¥”ã®é©è£½ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã§ã™ã€‚", "en": "This is a Koubou Kusabi leather pencil case."},
            {"id": 103, "jp": "ç§ã®LAMYã®Vistaã¯é€æ˜ã§ã™ã€‚", "en": "My LAMY Vista is transparent."},
            {"id": 104, "jp": "å½¼å¥³ã¯é‡åŸå·¥èŠ¸ã®è’”çµµãƒšãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "She has a Nohara Kogei maki-e pen."},
            {"id": 105, "jp": "å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã¯é«˜å“è³ªã§ã™ã€‚", "en": "Koubou Kusabi planners are high quality."},
            {"id": 106, "jp": "ç§ã¯LAMYã®Joyã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a LAMY Joy."},
            {"id": 107, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯è·äººã«ã‚ˆã£ã¦ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei fountain pens are made by craftsmen."},
            {"id": 108, "jp": "ã“ã‚Œã¯å·¥æˆ¿æ¥”ã®é©è£½ãƒãƒ¼ãƒˆã‚«ãƒãƒ¼ã§ã™ã€‚", "en": "This is a Koubou Kusabi leather notebook cover."},
            {"id": 109, "jp": "å½¼ã®LAMYã®CP1ã¯ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "His LAMY CP1 has a simple design."},
            {"id": 110, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®æ¼†å¡—ã‚Šãƒšãƒ³ãŒå¥½ãã§ã™ã€‚", "en": "I like Nohara Kogei lacquer pens."},
            {"id": 111, "jp": "å·¥æˆ¿æ¥”ã®ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã¯ä¸ˆå¤«ã§ã™ã€‚", "en": "Koubou Kusabi pencil cases are durable."},
            {"id": 112, "jp": "ã“ã‚Œã¯LAMYã®Dialog3ã§ã™ã€‚", "en": "This is a LAMY Dialog3."},
            {"id": 113, "jp": "é‡åŸå·¥èŠ¸ã®ãƒšãƒ³ã¯æ—¥æœ¬ã®ä¼çµ±å·¥èŠ¸ã§ã™ã€‚", "en": "Nohara Kogei pens are Japanese traditional crafts."},
            {"id": 114, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã‚’æ¯æ—¥ä½¿ã„ã¾ã™ã€‚", "en": "I use a Koubou Kusabi planner every day."},
            {"id": 115, "jp": "å½¼å¥³ã®LAMYã®Logoã¯ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹è£½ã§ã™ã€‚", "en": "Her LAMY Logo is made of stainless steel."},
            {"id": 116, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯è´ˆã‚Šç‰©ã«æœ€é©ã§ã™ã€‚", "en": "Nohara Kogei fountain pens are perfect for gifts."},
            {"id": 117, "jp": "å·¥æˆ¿æ¥”ã®é©è£½å“ã¯æ‰‹ä½œã‚Šã§ã™ã€‚", "en": "Koubou Kusabi leather products are handmade."},
            {"id": 118, "jp": "ã“ã‚Œã¯LAMYã®Nexxã§ã™ã€‚", "en": "This is a LAMY Nexx."},
            {"id": 119, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®é™å®šç‰ˆãƒšãƒ³ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚", "en": "I collect limited edition Nohara Kogei pens."},
            {"id": 120, "jp": "å·¥æˆ¿æ¥”ã®ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã¯æ©Ÿèƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚", "en": "Koubou Kusabi pencil cases are highly functional."},
            {"id": 121, "jp": "ãã®LAMYã®Aionã¯ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ è£½ã§ã™ã€‚", "en": "That LAMY Aion is made of aluminum."},
            {"id": 122, "jp": "é‡åŸå·¥èŠ¸ã®è’”çµµæŠ€è¡“ã¯ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚", "en": "Nohara Kogei maki-e techniques are wonderful."},
            {"id": 123, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚±ãƒ¼ã‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a Koubou Kusabi passport case."},
            {"id": 124, "jp": "ã“ã®LAMYã®Scalaã¯é«˜ç´šæ„ŸãŒã‚ã‚Šã¾ã™ã€‚", "en": "This LAMY Scala has a luxurious feel."},
            {"id": 125, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯æ›¸ãå¿ƒåœ°ãŒè‰¯ã„ã§ã™ã€‚", "en": "Nohara Kogei fountain pens have a good writing feel."},
            {"id": 126, "jp": "å·¥æˆ¿æ¥”ã®é©ã¯æŸ”ã‚‰ã‹ã„ã§ã™ã€‚", "en": "Koubou Kusabi leather is soft."},
            {"id": 127, "jp": "ç§ã¯LAMYã®Accentã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a LAMY Accent."},
            {"id": 128, "jp": "é‡åŸå·¥èŠ¸ã®ãƒšãƒ³ã¯è·äººã®æŠ€è¡“ã®çµæ™¶ã§ã™ã€‚", "en": "Nohara Kogei pens are the crystallization of craftsman skills."},
            {"id": 129, "jp": "ã“ã‚Œã¯å·¥æˆ¿æ¥”ã®ãƒšãƒ³ãƒãƒ¼ãƒã§ã™ã€‚", "en": "This is a Koubou Kusabi pen pouch."},
            {"id": 130, "jp": "å½¼ã®LAMYã®Imporiumã¯é«˜ä¾¡ã§ã™ã€‚", "en": "His LAMY Imporium is expensive."},
            {"id": 131, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®è’”çµµãƒšãƒ³ã‚’è³¼å…¥ã—ã¾ã—ãŸã€‚", "en": "I purchased a Nohara Kogei maki-e pen."},
            {"id": 132, "jp": "å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã¯ç¾ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "Koubou Kusabi planners have beautiful designs."},
            {"id": 133, "jp": "ã“ã®LAMYã®Studioã¯ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã§ã™ã€‚", "en": "This LAMY Studio is elegant."},
            {"id": 134, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼ã«äººæ°—ã§ã™ã€‚", "en": "Nohara Kogei fountain pens are popular with collectors."},
            {"id": 135, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a Koubou Kusabi card case."},
            {"id": 136, "jp": "ãã®LAMYã®Purã¯ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è£½ã§ã™ã€‚", "en": "That LAMY Pur is made of plastic."},
            {"id": 137, "jp": "é‡åŸå·¥èŠ¸ã®æ¼†å¡—ã‚ŠæŠ€è¡“ã¯ä¼çµ±çš„ã§ã™ã€‚", "en": "Nohara Kogei lacquer techniques are traditional."},
            {"id": 138, "jp": "å·¥æˆ¿æ¥”ã®è£½å“ã¯é•·æŒã¡ã—ã¾ã™ã€‚", "en": "Koubou Kusabi products last long."},
            {"id": 139, "jp": "ã“ã‚Œã¯LAMYã®AL-starã§ã™ã€‚", "en": "This is a LAMY AL-star."},
            {"id": 140, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®é™å®šç‰ˆã‚’æ¢ã—ã¦ã„ã¾ã™ã€‚", "en": "I am looking for a limited edition Nohara Kogei."},
            {"id": 141, "jp": "å·¥æˆ¿æ¥”ã®é©è£½å“ã¯æ‰‹å…¥ã‚ŒãŒå¿…è¦ã§ã™ã€‚", "en": "Koubou Kusabi leather products require care."},
            {"id": 142, "jp": "ãã®LAMYã®Vistaã¯å®Ÿç”¨çš„ã§ã™ã€‚", "en": "That LAMY Vista is practical."},
            {"id": 143, "jp": "é‡åŸå·¥èŠ¸ã®è’”çµµã¯èŠ¸è¡“ä½œå“ã§ã™ã€‚", "en": "Nohara Kogei maki-e is an artwork."},
            {"id": 144, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ãƒãƒ¼ãƒˆã‚«ãƒãƒ¼ã‚’è²·ã„ã¾ã—ãŸã€‚", "en": "I bought a Koubou Kusabi notebook cover."},
            {"id": 145, "jp": "ã“ã®LAMYã®Joyã¯ã‚«ãƒªã‚°ãƒ©ãƒ•ã‚£ãƒ¼ç”¨ã§ã™ã€‚", "en": "This LAMY Joy is for calligraphy."},
            {"id": 146, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯æ—¥æœ¬æ–‡åŒ–ã‚’åæ˜ ã—ã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei fountain pens reflect Japanese culture."},
            {"id": 147, "jp": "å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã¯æ©Ÿèƒ½æ€§ã¨ãƒ‡ã‚¶ã‚¤ãƒ³æ€§ã‚’å…¼ã­å‚™ãˆã¦ã„ã¾ã™ã€‚", "en": "Koubou Kusabi planners combine functionality and design."},
            {"id": 148, "jp": "ç§ã¯LAMYã®LogoãŒå¥½ãã§ã™ã€‚", "en": "I like the LAMY Logo."},
            {"id": 149, "jp": "é‡åŸå·¥èŠ¸ã®ãƒšãƒ³ã¯ç‰¹åˆ¥ãªè´ˆã‚Šç‰©ã§ã™ã€‚", "en": "Nohara Kogei pens are special gifts."},
            {"id": 150, "jp": "ã“ã‚Œã¯å·¥æˆ¿æ¥”ã®é©è£½ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã§ã™ã€‚", "en": "This is a Koubou Kusabi leather pencil case."},
            {"id": 151, "jp": "ãã®LAMYã®Dialog3ã¯å›è»¢å¼ã§ã™ã€‚", "en": "That LAMY Dialog3 is a twist-action pen."},
            {"id": 152, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®è’”çµµæŠ€è¡“ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚", "en": "I am interested in Nohara Kogei maki-e techniques."},
            {"id": 153, "jp": "å·¥æˆ¿æ¥”ã®è£½å“ã¯è·äººã®æ‰‹ã§ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Koubou Kusabi products are made by craftsmen's hands."},
            {"id": 154, "jp": "ã“ã®LAMYã®Nexxã¯è»½é‡ã§ã™ã€‚", "en": "This LAMY Nexx is lightweight."},
            {"id": 155, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯ä¼çµ±ã¨é©æ–°ã®èåˆã§ã™ã€‚", "en": "Nohara Kogei fountain pens are a fusion of tradition and innovation."},
            {"id": 156, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚±ãƒ¼ã‚¹ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚", "en": "I use a Koubou Kusabi passport case."},
            {"id": 157, "jp": "ãã®LAMYã®Aionã¯æ´—ç·´ã•ã‚ŒãŸãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "That LAMY Aion has a refined design."},
            {"id": 158, "jp": "é‡åŸå·¥èŠ¸ã®æ¼†å¡—ã‚Šãƒšãƒ³ã¯ç¾ã—ã„ã§ã™ã€‚", "en": "Nohara Kogei lacquer pens are beautiful."},
            {"id": 159, "jp": "å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã¯æŒã¡ã‚„ã™ã„ã§ã™ã€‚", "en": "Koubou Kusabi planners are easy to carry."},
            {"id": 160, "jp": "ã“ã‚Œã¯LAMYã®Scalaã§ã™ã€‚", "en": "This is a LAMY Scala."},
            {"id": 161, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®é™å®šç‰ˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a limited edition Nohara Kogei collection."},
            {"id": 162, "jp": "å·¥æˆ¿æ¥”ã®é©è£½å“ã¯æ™‚é–“ã¨ã¨ã‚‚ã«å‘³ãŒå‡ºã¾ã™ã€‚", "en": "Koubou Kusabi leather products develop character over time."},
            {"id": 163, "jp": "ãã®LAMYã®Accentã¯äº¤æ›å¯èƒ½ãªã‚°ãƒªãƒƒãƒ—ã§ã™ã€‚", "en": "That LAMY Accent has an interchangeable grip."},
            {"id": 164, "jp": "é‡åŸå·¥èŠ¸ã®è’”çµµã¯ç´°ã‹ã„ä½œæ¥­ã§ã™ã€‚", "en": "Nohara Kogei maki-e is detailed work."},
            {"id": 165, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ãƒšãƒ³ãƒãƒ¼ãƒã‚’æŒã£ã¦ã„ã¾ã™ã€‚", "en": "I have a Koubou Kusabi pen pouch."},
            {"id": 166, "jp": "ã“ã®LAMYã®Imporiumã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚", "en": "This LAMY Imporium is a premium model."},
            {"id": 167, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯æ›¸ãå‘³ãŒæ»‘ã‚‰ã‹ã§ã™ã€‚", "en": "Nohara Kogei fountain pens write smoothly."},
            {"id": 168, "jp": "å·¥æˆ¿æ¥”ã®ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹ã¯ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã§ã™ã€‚", "en": "Koubou Kusabi card cases are compact."},
            {"id": 169, "jp": "ãã®LAMYã®Purã¯ã‚«ãƒ©ãƒ•ãƒ«ã§ã™ã€‚", "en": "That LAMY Pur is colorful."},
            {"id": 170, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®ä¼çµ±å·¥èŠ¸ã«æ„Ÿå‹•ã—ã¾ã—ãŸã€‚", "en": "I was moved by Nohara Kogei traditional crafts."},
            {"id": 171, "jp": "å·¥æˆ¿æ¥”ã®è£½å“ã¯ä¸å¯§ã«ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Koubou Kusabi products are carefully made."},
            {"id": 172, "jp": "ã“ã‚Œã¯LAMYã®AL-starã§ã™ã€‚", "en": "This is a LAMY AL-star."},
            {"id": 173, "jp": "é‡åŸå·¥èŠ¸ã®è’”çµµãƒšãƒ³ã¯ä¸€ç‚¹ä¸€ç‚¹ç•°ãªã‚Šã¾ã™ã€‚", "en": "Each Nohara Kogei maki-e pen is unique."},
            {"id": 174, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã‚’æ„›ç”¨ã—ã¦ã„ã¾ã™ã€‚", "en": "I love using Koubou Kusabi planners."},
            {"id": 175, "jp": "ãã®LAMYã®Vistaã¯é€æ˜ãªãƒœãƒ‡ã‚£ã§ã™ã€‚", "en": "That LAMY Vista has a transparent body."},
            {"id": 176, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯è·äººã®èª‡ã‚Šã§ã™ã€‚", "en": "Nohara Kogei fountain pens are a craftsman's pride."},
            {"id": 177, "jp": "å·¥æˆ¿æ¥”ã®é©ã¯é«˜ç´šæ„ŸãŒã‚ã‚Šã¾ã™ã€‚", "en": "Koubou Kusabi leather has a luxurious feel."},
            {"id": 178, "jp": "ã“ã®LAMYã®Joyã¯ç­†è¨˜ç”¨ã«æœ€é©ã§ã™ã€‚", "en": "This LAMY Joy is perfect for writing."},
            {"id": 179, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®è’”çµµã‚’è¦‹ã‚‹ã®ãŒå¥½ãã§ã™ã€‚", "en": "I like looking at Nohara Kogei maki-e."},
            {"id": 180, "jp": "å·¥æˆ¿æ¥”ã®ãƒãƒ¼ãƒˆã‚«ãƒãƒ¼ã¯ä¿è­·æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚", "en": "Koubou Kusabi notebook covers have protective functions."},
            {"id": 181, "jp": "ãã®LAMYã®Logoã¯ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "That LAMY Logo has a simple design."},
            {"id": 182, "jp": "é‡åŸå·¥èŠ¸ã®æ¼†å¡—ã‚Šã¯ä½•å±¤ã«ã‚‚é‡ã­ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei lacquer is applied in multiple layers."},
            {"id": 183, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ãƒšãƒ³ã‚±ãƒ¼ã‚¹ã‚’æ¯æ—¥ä½¿ã„ã¾ã™ã€‚", "en": "I use a Koubou Kusabi pencil case every day."},
            {"id": 184, "jp": "ã“ã‚Œã¯LAMYã®Dialog3ã§ã™ã€‚", "en": "This is a LAMY Dialog3."},
            {"id": 185, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯ä¸–ä»£ã‚’è¶…ãˆã¦æ„›ã•ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei fountain pens are loved across generations."},
            {"id": 186, "jp": "å·¥æˆ¿æ¥”ã®æ‰‹å¸³ã¯å®Ÿç”¨çš„ã§ã™ã€‚", "en": "Koubou Kusabi planners are practical."},
            {"id": 187, "jp": "ãã®LAMYã®Nexxã¯ã‚¨ãƒ«ã‚´ãƒãƒŸãƒƒã‚¯ãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "That LAMY Nexx has an ergonomic design."},
            {"id": 188, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®é™å®šç‰ˆã‚’æ¢ã—ã¦ã„ã¾ã™ã€‚", "en": "I am searching for a limited edition Nohara Kogei."},
            {"id": 189, "jp": "å·¥æˆ¿æ¥”ã®ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚±ãƒ¼ã‚¹ã¯æ—…è¡Œã«ä¾¿åˆ©ã§ã™ã€‚", "en": "Koubou Kusabi passport cases are convenient for travel."},
            {"id": 190, "jp": "ã“ã®LAMYã®Aionã¯ç¾ä»£çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚", "en": "This LAMY Aion has a modern design."},
            {"id": 191, "jp": "é‡åŸå·¥èŠ¸ã®è’”çµµæŠ€è¡“ã¯å¾Œä¸–ã«ä¼ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei maki-e techniques are passed down to future generations."},
            {"id": 192, "jp": "ç§ã¯å·¥æˆ¿æ¥”ã®ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹ã‚’è³¼å…¥ã—ã¾ã—ãŸã€‚", "en": "I purchased a Koubou Kusabi card case."},
            {"id": 193, "jp": "ãã®LAMYã®Scalaã¯é«˜ç´šæ„ŸãŒã‚ã‚Šã¾ã™ã€‚", "en": "That LAMY Scala has a luxurious feel."},
            {"id": 194, "jp": "é‡åŸå·¥èŠ¸ã®ä¸‡å¹´ç­†ã¯æ‰‹ä½œæ¥­ã§ä½œã‚‰ã‚Œã¾ã™ã€‚", "en": "Nohara Kogei fountain pens are made by hand."},
            {"id": 195, "jp": "å·¥æˆ¿æ¥”ã®é©è£½å“ã¯ä¸€ç”Ÿã‚‚ã®ã§ã™ã€‚", "en": "Koubou Kusabi leather products last a lifetime."},
            {"id": 196, "jp": "ã“ã‚Œã¯LAMYã®Accentã§ã™ã€‚", "en": "This is a LAMY Accent."},
            {"id": 197, "jp": "ç§ã¯é‡åŸå·¥èŠ¸ã®æ¼†å¡—ã‚Šãƒšãƒ³ã‚’ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã—ã¦ã„ã¾ã™ã€‚", "en": "I collect Nohara Kogei lacquer pens."},
            {"id": 198, "jp": "å·¥æˆ¿æ¥”ã®ãƒšãƒ³ãƒãƒ¼ãƒã¯åç´åŠ›ãŒã‚ã‚Šã¾ã™ã€‚", "en": "Koubou Kusabi pen pouches have good storage capacity."},
            {"id": 199, "jp": "ãã®LAMYã®Imporiumã¯æœ€é«˜ç´šãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚", "en": "That LAMY Imporium is the top model."},
            {"id": 200, "jp": "é‡åŸå·¥èŠ¸ã¨å·¥æˆ¿æ¥”ã¯æ—¥æœ¬ã®è·äººæŠ€è¡“ã‚’ä»£è¡¨ã—ã¦ã„ã¾ã™ã€‚", "en": "Nohara Kogei and Koubou Kusabi represent Japanese craftsmanship."}
        ];

        let currentLevel = null;
        let rawQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let hintsUsed = 0;
        let maxStreak = 0;
        let hasAnswered = false;
        let hintRevealedThisQuestion = false;
        let currentSentenceTokens = [];
        let wordBankTokens = [];
        let assembledTokens = [];
        let draggingTokenId = null;
        let dragSource = null;
        let activePointerId = null;
        let dragGhost = null;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let dragStartX = 0;
        let dragStartY = 0;
        let pointerDragActive = false;
        let pointerDragJustFinished = false;
        let wrongAnswers = [];

        const levelSelection = document.getElementById('level-selection');
        const quizContainer = document.getElementById('quiz-container');
        const reviewContainer = document.getElementById('review-container');
        const beginnerBtn = document.getElementById('beginner-btn');
        const intermediateBtn = document.getElementById('intermediate-btn');
        const backToLevelsBtn = document.getElementById('back-to-levels');
        const currentLevelSpan = document.getElementById('current-level');
        const reviewWrongBtn = document.getElementById('review-wrong-btn');
        const closeReviewBtn = document.getElementById('close-review');
        const reviewList = document.getElementById('review-list');
        const quizApp = document.querySelector('main');
        const progressDisplay = document.getElementById('progress');
        const progressBar = document.getElementById('progress-bar');
        const scoreDisplay = document.getElementById('score-display');
        const streakDisplay = document.getElementById('streak-display');
        const hintUsageDisplay = document.getElementById('hint-usage');
        const japaneseText = document.getElementById('japanese-text');
        const checkButton = document.getElementById('check-button');
        const nextButton = document.getElementById('next-button');
        const feedbackArea = document.getElementById('feedback-area');
        const answerBox = document.getElementById('answer-box');
        const correctAnswerText = document.getElementById('correct-answer');
        const hintButton = document.getElementById('hint-button');
        const hintText = document.getElementById('hint-text');
        const wordBankContainer = document.getElementById('word-bank');
        const assembledContainer = document.getElementById('assembled-answer');
        const confettiContainer = document.getElementById('confetti-container');

        let questions = [];
        let totalQuestions = 0;

        // DOMãŒèª­ã¿è¾¼ã¾ã‚ŒãŸå¾Œã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
            levelSelection.classList.remove('hidden');
            quizContainer.classList.add('hidden');
            reviewContainer.classList.add('hidden');
        });

        beginnerBtn.addEventListener('click', () => startQuiz('beginner'));
        intermediateBtn.addEventListener('click', () => startQuiz('intermediate'));
        backToLevelsBtn.addEventListener('click', () => {
            if (confirm('ãƒ¬ãƒ™ãƒ«é¸æŠã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿç¾åœ¨ã®é€²æ—ã¯å¤±ã‚ã‚Œã¾ã™ã€‚')) {
                resetQuiz();
                levelSelection.classList.remove('hidden');
                quizContainer.classList.add('hidden');
                reviewContainer.classList.add('hidden');
            }
        });
        reviewWrongBtn.addEventListener('click', () => {
            reviewContainer.classList.remove('hidden');
            quizContainer.classList.add('hidden');
            displayReview();
        });
        closeReviewBtn.addEventListener('click', () => {
            reviewContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
        });

        function startQuiz(level) {
            currentLevel = level;
            rawQuestions = level === 'beginner' ? beginnerQuestions : intermediateQuestions;
            questions = shuffle(rawQuestions.map(({ id, jp, en }) => ({ id, japanese: jp, english: en })));
            totalQuestions = rawQuestions.length;
            wrongAnswers = [];
            
            resetQuiz();
            levelSelection.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            reviewContainer.classList.add('hidden');
            
            currentLevelSpan.textContent = level === 'beginner' ? 'ğŸ“š åˆç´š' : 'ğŸ“ ä¸­ç´š';
            loadQuestion();
            updateProgress();
        }

        function resetQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            hintsUsed = 0;
            maxStreak = 0;
            wrongAnswers = [];
            reviewWrongBtn.classList.add('hidden');
        }

        function shuffle(array) {
            const copy = [...array];
            for (let i = copy.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [copy[i], copy[j]] = [copy[j], copy[i]];
            }
            return copy;
        }

        function tokenizeSentence(sentence) {
            return sentence.split(' ').filter(Boolean);
        }

        function generateHint(question) {
            const brandMatches = question.japanese.match(/[A-Za-z][A-Za-z-]*/g);
            if (brandMatches && brandMatches.length > 0) {
                const unique = [...new Set(brandMatches.map((word) => word.replace(/[^A-Za-z-]/g, '')))].filter(Boolean);
                if (unique.length > 0) {
                    return `ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ’ãƒ³ãƒˆ: ${unique.join(', ')}`;
                }
            }
            return 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨ãªã‚‹åè©ã«æ³¨ç›®ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚';
        }

        function createTokenObjects(tokens, questionId) {
            return tokens.map((text, index) => ({
                id: `${questionId}-${index}-${Math.random().toString(36).slice(2, 8)}`,
                text
            }));
        }

        function attachTokenInteractions(button, tokenId, source) {
            button.dataset.tokenId = tokenId;
            button.dataset.tokenSource = source;
            button.classList.add('token-button');

            button.addEventListener('pointerdown', (event) => {
                if (hasAnswered) return;
                if (event.button !== undefined && event.button !== 0) return;
                startPointerDrag(tokenId, source, event, button);
            });

            button.addEventListener('click', (event) => {
                if (pointerDragJustFinished) {
                    pointerDragJustFinished = false;
                    event.preventDefault();
                    return;
                }
                if (hasAnswered) return;
                if (source === 'bank') {
                    moveTokenToAnswer(tokenId);
                } else {
                    moveTokenBackToBank(tokenId);
                }
            });
        }

        function startPointerDrag(tokenId, source, event, element) {
            draggingTokenId = tokenId;
            dragSource = source;
            activePointerId = event.pointerId;
            pointerDragActive = false;
            pointerDragJustFinished = false;
            dragStartX = event.clientX;
            dragStartY = event.clientY;

            const rect = element.getBoundingClientRect();
            dragOffsetX = event.clientX - rect.left;
            dragOffsetY = event.clientY - rect.top;

            dragGhost = element.cloneNode(true);
            dragGhost.removeAttribute('id');
            dragGhost.classList.add('pointer-events-none');
            dragGhost.style.position = 'fixed';
            dragGhost.style.left = `${rect.left}px`;
            dragGhost.style.top = `${rect.top}px`;
            dragGhost.style.width = `${rect.width}px`;
            dragGhost.style.zIndex = '9999';
            dragGhost.style.opacity = '0.9';
            dragGhost.style.transform = 'scale(1.05)';
            dragGhost.style.pointerEvents = 'none';
            document.body.appendChild(dragGhost);

            element.setPointerCapture(event.pointerId);
            element.addEventListener('pointermove', handlePointerMove);
            element.addEventListener('pointerup', endPointerDrag);
            element.addEventListener('pointercancel', cancelPointerDrag);
        }

        function handlePointerMove(event) {
            if (event.pointerId !== activePointerId || draggingTokenId === null || !dragGhost) {
                return;
            }

            const deltaX = event.clientX - dragStartX;
            const deltaY = event.clientY - dragStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            if (!pointerDragActive && distance > 5) {
                pointerDragActive = true;
            }

            if (pointerDragActive) {
                event.preventDefault();
                dragGhost.style.left = `${event.clientX - dragOffsetX}px`;
                dragGhost.style.top = `${event.clientY - dragOffsetY}px`;
            }
        }

        function endPointerDrag(event) {
            if (event.pointerId !== activePointerId) return;
            cleanupPointerListeners(event.currentTarget, event.pointerId);

            if (!draggingTokenId) return;

            const wasDragging = pointerDragActive;
            pointerDragActive = false;
            pointerDragJustFinished = wasDragging;

            if (dragGhost) {
                dragGhost.remove();
                dragGhost = null;
            }

            if (!wasDragging) {
                resetPointerDragState();
                return;
            }

            const dropElement = document.elementFromPoint(event.clientX, event.clientY);
            if (dropElement) {
                const assembledArea = dropElement.closest('#assembled-answer');
                const bankArea = dropElement.closest('#word-bank');

                if (assembledArea) {
                    const beforeToken = dropElement.closest('.token-button');
                    const beforeId = beforeToken ? beforeToken.dataset.tokenId : null;
                    moveTokenToAssembledAt(draggingTokenId, beforeId);
                } else if (bankArea) {
                    const beforeToken = dropElement.closest('.token-button');
                    const beforeId = beforeToken ? beforeToken.dataset.tokenId : null;
                    moveTokenToWordBankAt(draggingTokenId, beforeId);
                } else {
                    renderWordBank();
                    renderAssembled();
                    updateCheckButtonState();
                }
            }

            resetPointerDragState();
        }

        function cancelPointerDrag(event) {
            if (event.pointerId !== activePointerId) return;
            cleanupPointerListeners(event.currentTarget, event.pointerId);

            if (dragGhost) {
                dragGhost.remove();
                dragGhost = null;
            }

            pointerDragJustFinished = false;
            resetPointerDragState();
        }

        function cleanupPointerListeners(target, pointerId) {
            try {
                target.releasePointerCapture(pointerId);
            } catch (e) {
                // ignore
            }
            target.removeEventListener('pointermove', handlePointerMove);
            target.removeEventListener('pointerup', endPointerDrag);
            target.removeEventListener('pointercancel', cancelPointerDrag);
        }

        function resetPointerDragState() {
            draggingTokenId = null;
            dragSource = null;
            activePointerId = null;
            dragOffsetX = 0;
            dragOffsetY = 0;
            dragStartX = 0;
            dragStartY = 0;
            pointerDragActive = false;
        }

        function moveTokenToAssembledAt(tokenId, beforeTokenId = null) {
            if (beforeTokenId === tokenId) {
                beforeTokenId = null;
            }
            const fromBankIndex = wordBankTokens.findIndex((token) => token.id === tokenId);
            const fromAssembledIndex = assembledTokens.findIndex((token) => token.id === tokenId);

            let token = null;
            if (fromBankIndex !== -1) {
                [token] = wordBankTokens.splice(fromBankIndex, 1);
            } else if (fromAssembledIndex !== -1) {
                [token] = assembledTokens.splice(fromAssembledIndex, 1);
            } else {
                return;
            }

            let insertIndex = beforeTokenId ? assembledTokens.findIndex((token) => token.id === beforeTokenId) : assembledTokens.length;
            if (insertIndex === -1) {
                insertIndex = assembledTokens.length;
            }
            assembledTokens.splice(insertIndex, 0, token);

            renderWordBank();
            renderAssembled();
            updateCheckButtonState();
        }

        function moveTokenToWordBankAt(tokenId, beforeTokenId = null) {
            if (beforeTokenId === tokenId) {
                beforeTokenId = null;
            }
            const fromBankIndex = wordBankTokens.findIndex((token) => token.id === tokenId);
            const fromAssembledIndex = assembledTokens.findIndex((token) => token.id === tokenId);

            let token = null;
            if (fromAssembledIndex !== -1) {
                [token] = assembledTokens.splice(fromAssembledIndex, 1);
            } else if (fromBankIndex !== -1) {
                [token] = wordBankTokens.splice(fromBankIndex, 1);
            } else {
                return;
            }

            let insertIndex = beforeTokenId ? wordBankTokens.findIndex((token) => token.id === beforeTokenId) : wordBankTokens.length;
            if (insertIndex === -1) {
                insertIndex = wordBankTokens.length;
            }
            wordBankTokens.splice(insertIndex, 0, token);

            renderWordBank();
            renderAssembled();
            updateCheckButtonState();
        }

        function renderWordBank() {
            wordBankContainer.innerHTML = '';
            wordBankTokens.forEach((token) => {
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = token.text;
                button.className = 'rounded-2xl border border-brand-200 bg-white px-4 py-2 text-sm font-medium text-brand-700 shadow-sm hover:border-brand-400 hover:shadow focus:outline-none transition';
                attachTokenInteractions(button, token.id, 'bank');
                if (hasAnswered) {
                    button.classList.add('opacity-50', 'cursor-not-allowed');
                    button.disabled = true;
                }
                wordBankContainer.appendChild(button);
            });
        }

        function renderAssembled() {
            assembledContainer.innerHTML = '';
            if (assembledTokens.length === 0) {
                const placeholder = document.createElement('p');
                placeholder.className = 'text-xs text-slate-400';
                placeholder.textContent = 'ã“ã“ã«ä¸¦ã¹ãŸå˜èªãŒè¡¨ç¤ºã•ã‚Œã¾ã™';
                assembledContainer.appendChild(placeholder);
                return;
            }

            assembledTokens.forEach((token) => {
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = token.text;
                button.className = 'rounded-2xl border border-brand-200 bg-brand-50 px-4 py-2 text-sm font-medium text-brand-700 shadow-sm hover:border-brand-400 hover:shadow focus:outline-none transition';
                attachTokenInteractions(button, token.id, 'assembled');
                if (hasAnswered) {
                    button.classList.add('opacity-50', 'cursor-not-allowed');
                    button.disabled = true;
                }
                assembledContainer.appendChild(button);
            });
        }

        function moveTokenToAnswer(tokenId) {
            if (hasAnswered) return;
            moveTokenToAssembledAt(tokenId, null);
        }

        function moveTokenBackToBank(tokenId) {
            if (hasAnswered) return;
            moveTokenToWordBankAt(tokenId, null);
        }

        function updateCheckButtonState() {
            const ready = assembledTokens.length === currentSentenceTokens.length && currentSentenceTokens.length > 0;
            checkButton.disabled = hasAnswered || !ready;
        }

        function updateProgress() {
            const displayIndex = Math.min(currentQuestionIndex + 1, totalQuestions);
            progressDisplay.textContent = `å• ${displayIndex} / ${totalQuestions}`;
            const percentage = (currentQuestionIndex / totalQuestions) * 100;
            progressBar.style.width = `${percentage}%`;
        }

        function loadQuestion() {
            if (currentQuestionIndex >= totalQuestions) {
                showResults();
                return;
            }

            const question = questions[currentQuestionIndex];
            japaneseText.textContent = question.japanese;

            currentSentenceTokens = tokenizeSentence(question.english);
            wordBankTokens = shuffle(createTokenObjects(currentSentenceTokens, question.id));
            assembledTokens = [];
            hasAnswered = false;
            hintRevealedThisQuestion = false;

            renderWordBank();
            renderAssembled();
            updateCheckButtonState();

            hintText.textContent = generateHint(question);
            hintText.classList.add('hidden');
            hintButton.disabled = false;
            hintButton.textContent = 'ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹';

            checkButton.classList.remove('hidden');
            nextButton.disabled = true;
            nextButton.classList.add('hidden');

            answerBox.classList.add('hidden');
            feedbackArea.innerHTML = '';

            updateProgress();
        }

        function showConfetti() {
            const colors = ['#38bdf8', '#818cf8', '#f472b6', '#fbbf24', '#34d399'];
            const pieceCount = 40;

            for (let i = 0; i < pieceCount; i++) {
                const piece = document.createElement('div');
                const start = Math.random();
                const end = start + (Math.random() * 0.2 - 0.1);

                piece.className = 'confetti-piece';
                piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                piece.style.left = `${start * 100}%`;
                piece.style.setProperty('--x-start', `${start * 100}vw`);
                piece.style.setProperty('--x-end', `${end * 100}vw`);
                piece.style.animation = `confettiFall ${Math.random() * 1.5 + 1.8}s linear forwards`;

                confettiContainer.appendChild(piece);

                setTimeout(() => piece.remove(), 2500);
            }
        }

        function buildFeedback(isCorrect) {
            if (isCorrect) {
                const messages = [
                    'å®Œç’§ï¼ãã®è¨³ã—æ–¹ã€ã¨ã¦ã‚‚è‡ªç„¶ã§ã™ã€‚',
                    'ç´ æ™´ã‚‰ã—ã„ã‚»ãƒ³ã‚¹ï¼æ¬¡ã®å•é¡Œã‚‚ã„ã‘ãã†ã§ã™ã­ã€‚',
                    'ãƒŠã‚¤ã‚¹ç¿»è¨³ï¼æ–‡æˆ¿å…·æ„›ãŒä¼ã‚ã‚Šã¾ã™ã€‚'
                ];
                const compliment = messages[Math.floor(Math.random() * messages.length)];
                return `
                    <div class="rounded-2xl border-2 border-green-400 bg-gradient-to-br from-green-50 to-emerald-50 p-6 md:p-8 shadow-lg slide-in">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="text-4xl">ğŸ‰</span>
                            <p class="text-2xl font-black text-green-700">æ­£è§£ã§ã™ï¼</p>
                        </div>
                        <p class="text-lg text-green-800 mb-4 font-medium">${compliment}</p>
                        <div class="flex items-center gap-4 text-sm">
                            <span class="px-3 py-1 rounded-full bg-green-200 text-green-800 font-semibold">é€£ç¶šæ­£è§£: ${streak}å•</span>
                            <span class="px-3 py-1 rounded-full bg-green-200 text-green-800 font-semibold">ã‚¹ã‚³ã‚¢: ${score}å•</span>
                        </div>
                    </div>
                `;
            }

            const tips = [
                'å˜èªã®é †åºã¨å† è©ã‚’ã‚‚ã†ä¸€åº¦ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†ã€‚',
                'è¤‡æ•°å½¢ãƒ»å˜æ•°å½¢ã«æ³¨æ„ã—ã¦ä¸¦ã¹æ›¿ãˆã¦ã¿ã¦ãã ã•ã„ã€‚',
                'ãƒ–ãƒ©ãƒ³ãƒ‰åãªã©å›ºæœ‰åè©ã®ä½ç½®ã‚’æ„è­˜ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚'
            ];
            const hint = tips[Math.floor(Math.random() * tips.length)];

            return `
                <div class="rounded-2xl border-2 border-rose-300 bg-gradient-to-br from-rose-50 to-pink-50 p-6 md:p-8 shadow-lg slide-in">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-4xl">â—</span>
                        <p class="text-2xl font-black text-rose-700">æ®‹å¿µã€ä¸æ­£è§£ã§ã™ã€‚</p>
                    </div>
                    <p class="text-lg text-rose-800 mb-4 font-medium">${hint}</p>
                    <div class="flex items-center gap-4 text-sm">
                        <span class="px-3 py-1 rounded-full bg-rose-200 text-rose-800 font-semibold">é€£ç¶šæ­£è§£: ${streak}å•</span>
                    </div>
                </div>
            `;
        }

        function checkAnswer() {
            if (hasAnswered) return;

            if (assembledTokens.length !== currentSentenceTokens.length) {
                feedbackArea.innerHTML = `
                    <div class="rounded-2xl border border-amber-200 bg-amber-50 p-4 md:p-5 shadow-sm text-amber-700">
                        <p class="font-semibold">ã™ã¹ã¦ã®å˜èªã‚’ä¸¦ã¹ã¦ã‹ã‚‰ç­”ãˆã‚’ç¢ºå®šã—ã¾ã—ã‚‡ã†ã€‚</p>
                    </div>
                `;
                return;
            }

            const userSentence = assembledTokens.map((token) => token.text).join(' ').trim();
            const question = questions[currentQuestionIndex];
            const correctSentence = question.english.trim();
            const isCorrect = userSentence === correctSentence;

            hasAnswered = true;

            if (isCorrect) {
                score++;
                streak++;
                maxStreak = Math.max(maxStreak, streak);
                showConfetti();
            } else {
                streak = 0;
                wrongAnswers.push({
                    japanese: question.japanese,
                    english: correctSentence,
                    userAnswer: userSentence
                });
            }

            feedbackArea.innerHTML = buildFeedback(isCorrect);
            correctAnswerText.textContent = correctSentence;
            answerBox.classList.remove('hidden');

            renderWordBank();
            renderAssembled();
            updateCheckButtonState();

            checkButton.classList.add('hidden');
            nextButton.disabled = false;
            nextButton.classList.remove('hidden');

            scoreDisplay.textContent = `æ­£è§£æ•°: ${score}`;
            streakDisplay.textContent = `é€£ç¶šæ­£è§£: ${streak}`;

            if (currentQuestionIndex === totalQuestions - 1) {
                nextButton.textContent = 'ğŸ¯ çµæœã‚’è¦‹ã‚‹';
            } else {
                nextButton.textContent = 'â¡ï¸ æ¬¡ã®å•é¡Œã¸';
            }

            if (wrongAnswers.length > 0) {
                reviewWrongBtn.classList.remove('hidden');
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        function displayReview() {
            if (wrongAnswers.length === 0) {
                reviewList.innerHTML = '<p class="text-center text-slate-600 py-8">é–“é•ã£ãŸå•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼âœ¨</p>';
                return;
            }

            reviewList.innerHTML = wrongAnswers.map((item, index) => `
                <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="flex items-start justify-between mb-4">
                        <h3 class="text-lg font-bold text-slate-900">å•é¡Œ ${index + 1}</h3>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">æ—¥æœ¬èª</p>
                            <p class="text-lg text-slate-900">${item.japanese}</p>
                        </div>
                        <div>
                            <p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">æ­£è§£</p>
                            <p class="text-lg font-mono text-green-700 bg-green-50 p-3 rounded-lg">${item.english}</p>
                        </div>
                        <div>
                            <p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">ã‚ãªãŸã®ç­”ãˆ</p>
                            <p class="text-lg font-mono text-rose-700 bg-rose-50 p-3 rounded-lg">${item.userAnswer}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showResults() {
            const accuracy = Math.round((score / totalQuestions) * 100);
            quizContainer.innerHTML = `
                <div class="glass-card rounded-3xl border border-white/60 px-6 py-12 md:px-12 md:py-16 shadow-xl text-center space-y-8">
                    <h2 class="text-4xl font-black text-brand-600">ãƒãƒ£ãƒ¬ãƒ³ã‚¸å®Œäº†ï¼</h2>
                    <p class="text-lg text-slate-600">ãŠç–²ã‚Œã•ã¾ã§ã—ãŸã€‚ä»Šå›ã®çµæœã¯ã“ã¡ã‚‰ã§ã™ã€‚</p>
                    <div class="flex flex-col md:flex-row items-center justify-center gap-6 md:gap-12">
                        <div class="rounded-2xl border border-brand-100 bg-brand-50 px-10 py-8 shadow-inner">
                            <p class="text-sm font-semibold text-brand-600 uppercase tracking-wide">ã‚¹ã‚³ã‚¢</p>
                            <p class="mt-3 text-5xl font-black text-brand-700">${score} / ${totalQuestions}</p>
                            <p class="mt-1 text-base text-brand-500">æ­£ç­”ç‡ ${accuracy}%</p>
                        </div>
                        <div class="rounded-2xl border border-slate-200 bg-white px-8 py-6 shadow-inner space-y-3 text-left">
                            <p class="text-sm text-slate-500 uppercase tracking-wide font-semibold">ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¡ãƒ¢</p>
                            <p class="text-base text-slate-700"><span class="font-semibold text-slate-900">ãƒ™ã‚¹ãƒˆé€£ç¶šæ­£è§£:</span> ${maxStreak} å•</p>
                            <p class="text-base text-slate-700"><span class="font-semibold text-slate-900">ãƒ’ãƒ³ãƒˆä½¿ç”¨:</span> ${hintsUsed} å›</p>
                            <p class="text-base text-slate-700"><span class="font-semibold text-slate-900">é–“é•ã£ãŸå•é¡Œ:</span> ${wrongAnswers.length} å•</p>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <p class="text-slate-600">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ã‚¹ã‚³ã‚¢æ›´æ–°ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¾ã—ã‚‡ã†ã€‚</p>
                        <div class="flex flex-col md:flex-row gap-3 justify-center">
                            ${wrongAnswers.length > 0 ? `<button onclick="window.location.reload()" class="inline-flex items-center gap-2 rounded-2xl bg-rose-600 px-6 py-3 text-base font-semibold text-white shadow-lg hover:bg-rose-700 transition">ğŸ“ é–“é•ã£ãŸå•é¡Œã‚’ç¢ºèªã™ã‚‹</button>` : ''}
                            <button onclick="window.location.reload()" class="inline-flex items-center gap-2 rounded-2xl bg-brand-600 px-6 py-3 text-base font-semibold text-white shadow-lg hover:bg-brand-700 transition">ğŸ” ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
                        </div>
                    </div>
                </div>
            `;
            
            // çµæœç”»é¢ã®é–“é•ã£ãŸå•é¡Œãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
            setTimeout(() => {
                const reviewBtn = document.querySelector('button[onclick*="é–“é•ã£ãŸå•é¡Œ"]');
                if (reviewBtn) {
                    reviewBtn.onclick = () => {
                        quizContainer.innerHTML = '';
                        reviewContainer.classList.remove('hidden');
                        displayReview();
                    };
                }
            }, 100);
        }

        hintButton.addEventListener('click', () => {
            const isHidden = hintText.classList.contains('hidden');
            if (isHidden) {
                hintText.classList.remove('hidden');
                hintButton.textContent = 'ğŸ™ˆ ãƒ’ãƒ³ãƒˆã‚’éš ã™';
                if (!hintRevealedThisQuestion) {
                    hintRevealedThisQuestion = true;
                    hintsUsed++;
                    hintUsageDisplay.textContent = `ãƒ’ãƒ³ãƒˆä½¿ç”¨: ${hintsUsed}`;
                }
            } else {
                hintText.classList.add('hidden');
                hintButton.textContent = 'ğŸ’¡ ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹';
            }
        });

        checkButton.addEventListener('click', checkAnswer);
        nextButton.addEventListener('click', nextQuestion);
    </script>
</body>
</html>
